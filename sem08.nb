(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     32454,        840]
NotebookOptionsPosition[     31103,        790]
NotebookOutlinePosition[     31444,        805]
CellTagsIndexPosition[     31401,        802]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"n", "=", "20"}], ";"}]], "Input",
 CellChangeTimes->{3.7011507911548023`*^9, 3.7024528588530664`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"x", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RandomReal", "[", "]"}], ",", " ", 
      RowBox[{"RandomReal", "[", "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.701150529322826*^9, 3.701150643364349*^9}, {
  3.70115078850165*^9, 3.701150789267694*^9}, {3.7024513376897964`*^9, 
  3.7024513451117563`*^9}, {3.7024521048422923`*^9, 3.702452105045437*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.7251555202759121`", ",", "0.5183712542116121`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.12728134556102022`", ",", "0.8326916340167123`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.23819267630426122`", ",", "0.6855468846839365`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.13328411252103156`", ",", "0.6657466691773202`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.17129805950903365`", ",", "0.34837984570228264`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.15477152675778427`", ",", "0.1623435148327803`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.8401283750706767`", ",", "0.3976704732658787`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.9993776942160923`", ",", "0.7034860900582451`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.3784243983365141`", ",", "0.012390180173676546`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.045848383504292656`", ",", "0.7858244019293952`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.8457965035174526`", ",", "0.07877037666803965`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.9512227884677915`", ",", "0.595046702502505`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5965649714218921`", ",", "0.37762544612826976`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.497032200751401`", ",", "0.2916532348389955`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.8282372801698021`", ",", "0.6198817900968632`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.9140182431197998`", ",", "0.3188878216078599`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5784011717523008`", ",", "0.3038565023095725`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.16992279936722587`", ",", "0.492935079315177`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.3645865208477881`", ",", "0.7511270120448388`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.19106283769214305`", ",", "0.9608345739899593`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.7011506439823837`*^9, 3.7011507940759687`*^9, 3.7011518265350223`*^9, 
   3.7011520326918135`*^9, 3.7011522585587325`*^9, 3.701152414698663*^9, 
   3.7011524825115423`*^9, 3.7011527812196274`*^9, 3.7011528192558026`*^9, 
   3.7011528758720407`*^9, 3.701153190486036*^9, 3.701153309462841*^9, 
   3.7011534218782706`*^9, 3.701153839036131*^9, 3.701154114977914*^9, 
   3.70115446843513*^9, {3.7011545199910793`*^9, 3.7011545460695705`*^9}, 
   3.701154655211813*^9, 3.7011547389296017`*^9, 3.7011548247165084`*^9, 
   3.7011549483425794`*^9, {3.7011550747058067`*^9, 3.701155083360302*^9}, 
   3.7024505197303677`*^9, 3.7024511513207536`*^9, 3.7024512612045565`*^9, 
   3.7024513456586027`*^9, 3.7024513869871454`*^9, 3.702451439277828*^9, 
   3.7024517477733636`*^9, 3.7024518315338974`*^9, {3.702451908050338*^9, 
   3.702451920925475*^9}, {3.7024520923109074`*^9, 3.7024521059673223`*^9}, 
   3.7024524120507107`*^9, 3.7024525044714003`*^9, 3.702452862353104*^9, 
   3.702453372767579*^9, 3.7024535515381904`*^9, 3.7024538220191016`*^9, 
   3.7024541263812747`*^9, 3.702454322664035*^9, 3.702454443229136*^9, 
   3.7024544851193094`*^9, 3.70245455740864*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"v", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"0.1", "*", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"RandomReal", "[", "]"}], "-", "0.5"}], ",", " ", 
       RowBox[{
        RowBox[{"RandomReal", "[", "]"}], "-", "0.5"}]}], "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.701150649320689*^9, 3.701150662556446*^9}, {
   3.701153300659337*^9, 3.701153305049588*^9}, 3.701153418234062*^9, {
   3.7011545230182524`*^9, 3.7011545255063944`*^9}, {3.7024513509711924`*^9, 
   3.7024513576743917`*^9}, {3.7024521021704426`*^9, 3.702452102357946*^9}, {
   3.7024544813223944`*^9, 3.7024545081737585`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.014993554681472322`", ",", 
     RowBox[{"-", "0.01957294243938279`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.002858751154947914`"}], ",", "0.028064609612179006`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.026076936412147658`", ",", 
     RowBox[{"-", "0.04876749185544456`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.03035524253612003`", ",", 
     RowBox[{"-", "0.04347679789774646`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.026611300918391215`"}], ",", 
     RowBox[{"-", "0.04262011160226769`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.021773348525962733`", ",", "0.040640298493127586`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.016259759162803002`"}], ",", "0.003674294853510074`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.022926374506798953`"}], ",", 
     RowBox[{"-", "0.03716934993944998`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.018117760250821235`", ",", "0.037754363928885516`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0.029877161899364825`", ",", "0.01767336466118945`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.04278769225285502`"}], ",", 
     RowBox[{"-", "0.03787295970381606`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.03264380595852683`", ",", "0.006637732416431974`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.01975661312816135`"}], ",", "0.02803718417840413`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.009771902510987408`", ",", "0.04242401662398709`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0.04936558133094489`", ",", 
     RowBox[{"-", "0.0031958407759598907`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.0295172804304801`", ",", "0.046971772468861084`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.03101911211997599`", ",", "0.04871487569623756`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.028650840838318637`", ",", "0.032602615841117344`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.017248833100295725`"}], ",", 
     RowBox[{"-", "0.020118595693168897`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.02289719839409439`"}], ",", "0.0019087869325304042`"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7011545257174063`*^9, 3.7011545472946405`*^9}, 
   3.701154656355879*^9, 3.701154740557695*^9, 3.7011548259165773`*^9, 
   3.701154949660655*^9, {3.7011550762318945`*^9, 3.7011550849743943`*^9}, 
   3.7024505218710337`*^9, 3.7024511527270164`*^9, 3.702451262345209*^9, {
   3.7024513580493364`*^9, 3.7024513880653005`*^9}, 3.7024514406997175`*^9, 
   3.702451749585864*^9, 3.7024518328932877`*^9, {3.702451909034725*^9, 
   3.7024519221598806`*^9}, {3.7024520937015667`*^9, 3.702452106936082*^9}, 
   3.7024524134100847`*^9, 3.702452505221408*^9, 3.702452863306241*^9, 
   3.7024533743144717`*^9, 3.7024535524913254`*^9, 3.7024538229722176`*^9, 
   3.7024541277250395`*^9, 3.7024543235356517`*^9, 3.702454444136797*^9, {
   3.702454482775533*^9, 3.702454508876875*^9}, 3.702454558658654*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"a", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0.0", ",", "0.0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.701150781835269*^9, 3.7011508048355846`*^9}, {
  3.7024513607837987`*^9, 3.7024513727995515`*^9}, {3.702451915378598*^9, 
  3.702451916925485*^9}, {3.702452099154785*^9, 3.702452100904764*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7011508053406134`*^9, 3.701151829069167*^9, 3.7011520343199067`*^9, 
   3.701152262147938*^9, {3.701152396035596*^9, 3.7011524174348197`*^9}, 
   3.7011524855697165`*^9, 3.7011527838557777`*^9, 3.701152826519218*^9, 
   3.70115287848219*^9, 3.701153193165189*^9, 3.7011533119159813`*^9, 
   3.701153842082305*^9, 3.701154116965027*^9, 3.701154472250348*^9, {
   3.701154528133545*^9, 3.7011545486357174`*^9}, 3.7011546582349863`*^9, 
   3.701154741908772*^9, 3.701154827507668*^9, 3.7011549511047373`*^9, {
   3.7011550775539703`*^9, 3.701155086312471*^9}, 3.7024505236856165`*^9, 
   3.702451154039533*^9, 3.702451263970209*^9, 3.702451389565297*^9, 
   3.702451441902856*^9, 3.7024517509296284`*^9, 3.7024518342839336`*^9, {
   3.7024519102534876`*^9, 3.702451923066123*^9}, {3.7024520946234317`*^9, 
   3.7024521080298243`*^9}, 3.7024524143476095`*^9, 3.702452506127668*^9, 
   3.7024528641187468`*^9, 3.7024533747519927`*^9, 3.70245355353823*^9, 
   3.7024538239097276`*^9, 3.702454128615673*^9, 3.7024543245403624`*^9, 
   3.7024544450174036`*^9, 3.702454486259965*^9, 3.7024545604712315`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"q", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"i", "\[LessEqual]", 
       RowBox[{"n", "/", "2"}]}], ",", "1", ",", 
      RowBox[{"-", "1"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.701151215518074*^9, 3.7011512792237177`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
   ",", "1", ",", "1", ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}]}], "}"}]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQAGKb2RnHkia/dvx24zhXMpC+7FunAqIdWD45gOh6m6AQ
EL085lkMiJZo02sC0Re/KLaD6EXOX3pBdNjdwK0gumSNyhEQ3eeUyZYCEhc9
pQGirWc6h4JovkU74kC0y/nsHBCdtf1fGYheojSpEUTfseaaCKI7WH4sBNFb
PyzQvjv1taOcS1YViBbj0eoA0TLiP6eD6JInyfNA9P79AkdBtNW0+vMg+pRs
9y0QnfZl9kcQvWX+c/F7QPqaaK4yiL7lIx0AolsnKEwA0S47fZeB6EkykidA
9JnNOu9AdB3DBrb7QLoidZsoiJ4U+FwKRH+YbKQCogGg7Kzn
  "]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"m", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"i", "\[LessEqual]", 
       RowBox[{"n", "/", "2"}]}], ",", "100", ",", "1"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7011512869151573`*^9, 3.701151295744663*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "100", ",", "100", ",", "100", ",", "100", ",", "100", ",", "100", ",", 
   "100", ",", "100", ",", "100", ",", "100", ",", "1", ",", "1", ",", "1", 
   ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
  "}"}]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQAOKYxewnkia/dvz6/AtXMpDecn21CogWtZB1BNGbLjWG
gGijvzKxIPqrUXoTiO4La28H0XoGVn0g+l97/VYQfexW1REQfYS7hy0FSO/m
/aQBomvu54aCaCaDJ3EgmvnE6hwQPX22RTmITr++rRFE94gbTATRKWYai0D0
jQ/Xte9Ofe0o5DKtCkQH9vh3gOgIcfEZIHrek+nzQPSL/cZHQbTetHnnQfST
uRtugehFX7Z+BNEL57NL3APStY86lEE0n69xAIheNMFtAog2ssxbBqKXy1ic
ANG7Nju/A9F1qifY7gNpi6VnRUH0ikAWaRCtN8VfBUQDAB6Orac=
  "]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"K", "=", 
  RowBox[{"-", "0.02"}]}]], "Input",
 CellChangeTimes->{{3.701151299566881*^9, 3.701151305591226*^9}, {
   3.7011513835436845`*^9, 3.701151384151719*^9}, 3.7011545539070187`*^9, 
   3.7024541889348316`*^9}],

Cell[BoxData[
 RowBox[{"-", "0.02`"}]], "Output",
 CellChangeTimes->{
  3.7011513070193076`*^9, 3.7011513847337523`*^9, 3.7011518331874027`*^9, 
   3.701152038586151*^9, 3.7011522663301773`*^9, 3.7011524215050526`*^9, 
   3.701152490445996*^9, 3.7011528296273956`*^9, 3.701152883283465*^9, 
   3.7011531973934307`*^9, 3.701153317371293*^9, 3.701153845629508*^9, 
   3.7011541208512497`*^9, 3.701154476575596*^9, {3.7011545524179335`*^9, 
   3.7011545542340374`*^9}, 3.701154662904253*^9, 3.701154746991063*^9, 
   3.7011549549179554`*^9, 3.7011550904127054`*^9, 3.7024505301232033`*^9, 
   3.7024511577895823`*^9, 3.702451267595248*^9, 3.702451393768469*^9, 
   3.702451445934168*^9, 3.70245175444531*^9, 3.702451838049592*^9, 
   3.7024519265349293`*^9, 3.7024521114986305`*^9, 3.702452417175747*^9, 
   3.7024525091526375`*^9, 3.7024528663687887`*^9, 3.702453379720791*^9, 
   3.702453556444511*^9, 3.7024538271441374`*^9, 3.7024541316625986`*^9, 
   3.7024541971380444`*^9, 3.702454328704311*^9, 3.702454447959488*^9, 
   3.7024544888224726`*^9, 3.7024545636743336`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"accel", "[", "dt_", "]"}], ":=", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"v", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "+=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "-", 
         RowBox[{"0.05", "*", 
          RowBox[{"v", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}]}], ")"}], "*", "dt"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.701153164054524*^9, 3.7011531790043793`*^9}, 
   3.7011532476713066`*^9, {3.7011547671452155`*^9, 3.7011547835441537`*^9}, 
   3.701154853344146*^9, 3.7024528315246487`*^9, 3.7024529222047763`*^9, 
   3.702453038518516*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"move", "[", "dt_", "]"}], ":=", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"x", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "+=", 
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "*", "dt"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7011506771332803`*^9, 3.7011507653573265`*^9}, 
   3.7011508119479914`*^9, {3.7011513426893477`*^9, 3.7011513458245273`*^9}, {
   3.701152352659115*^9, 3.70115235363317*^9}, {3.7011531715289516`*^9, 
   3.701153183481635*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"force", "[", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"d", ",", "r", ",", "f", ",", "e"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"d", "=", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "-", 
             RowBox[{"x", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"r", "=", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"d", ".", "d"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"f", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"K", "*", 
              RowBox[{"q", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"q", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], ")"}], "*", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"d", "/", "r"}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"r", "^", "2"}], "+", 
               RowBox[{"e", "^", "2"}]}], ")"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"e", "=", "0.02"}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"a", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "+=", 
           RowBox[{"f", "/", 
            RowBox[{"m", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"a", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "-=", 
           RowBox[{"f", "/", 
            RowBox[{"m", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"i", "+", "1"}], ",", "n"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.701150818699377*^9, 3.701150887035286*^9}, {
   3.701150918859106*^9, 3.7011512022433147`*^9}, {3.7011523609395885`*^9, 
   3.70115236394676*^9}, {3.701154930211542*^9, 3.7011549323846664`*^9}, {
   3.701154978860325*^9, 3.701154998110426*^9}, {3.702450634264921*^9, 
   3.702450650249467*^9}, {3.7024511008671465`*^9, 3.7024511077734127`*^9}, {
   3.7024511718366513`*^9, 3.702451173055361*^9}, {3.7024512408529563`*^9, 
   3.7024512474231586`*^9}, {3.7024514115655904`*^9, 3.702451421956287*^9}, {
   3.702451694835281*^9, 3.7024517344451356`*^9}, {3.7024520013724966`*^9, 
   3.702452033341586*^9}, 3.7024521850550556`*^9, {3.7024527684615355`*^9, 
   3.7024527909929686`*^9}, {3.702452873844939*^9, 3.7024528752668333`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"clear", "[", "]"}], ":=", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"0.0", ",", "0.0"}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7024518925346003`*^9, 3.70245190287846*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"bounds", "[", "]"}], ":=", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], ">", "1"}], ")"}], "&&", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"v", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], ">", "0"}], ")"}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "*=", 
         RowBox[{"-", "1"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "<", "0"}], ")"}], "&&", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"v", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "<", "0"}], ")"}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "*=", 
         RowBox[{"-", "1"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], ">", "1"}], ")"}], "&&", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"v", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], ">", "0"}], ")"}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "*=", 
         RowBox[{"-", "1"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "<", "0"}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"v", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "<", "0"}], ")"}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "*=", 
         RowBox[{"-", "1"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.701152503854763*^9, 3.7011527046262465`*^9}, {
  3.701152863712345*^9, 3.701152864856411*^9}, {3.7011529300241385`*^9, 
  3.7011529436789193`*^9}, {3.701153120764048*^9, 3.7011531290105195`*^9}, {
  3.701153372813464*^9, 3.701153404628284*^9}, {3.7011534788245277`*^9, 
  3.701153569734728*^9}, {3.701153614644296*^9, 3.7011537873451743`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ps", "=", "0.03"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Animate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"clear", "[", "]"}], ";", 
    RowBox[{"force", "[", "]"}], ";", 
    RowBox[{"accel", "[", "dt", "]"}], ";", 
    RowBox[{"bounds", "[", "]"}], ";", 
    RowBox[{"move", "[", "dt", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"PointSize", "[", "ps", "]"}], ",", "Blue", ",", 
        RowBox[{"Point", "[", 
         RowBox[{"x", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", 
            RowBox[{"n", "/", "2"}]}], "]"}], "]"}], "]"}], ",", "Red", ",", 
        RowBox[{"Point", "[", 
         RowBox[{"x", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"n", "/", "2"}], "+", "1"}], ";;", "n"}], "]"}], "]"}], 
         "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "ps"}], ",", 
           RowBox[{"1", "+", "ps"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "ps"}], ",", 
           RowBox[{"1", "+", "ps"}]}], "}"}]}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"dt", ",", "0", ",", "0.05", ",", "0.001"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"AnimationRunning", "\[Rule]", "False"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.701151401138691*^9, 3.7011514444141665`*^9}, {
   3.7011515672541924`*^9, 3.701151574581611*^9}, {3.7011516306778197`*^9, 
   3.701151648093816*^9}, {3.701151805357811*^9, 3.701151808607997*^9}, {
   3.7011519891403227`*^9, 3.7011520146037793`*^9}, {3.701152070195959*^9, 
   3.701152071395027*^9}, {3.7011523225773945`*^9, 3.7011523301698284`*^9}, {
   3.7011527153028564`*^9, 3.7011527536480503`*^9}, {3.701152980705037*^9, 
   3.701153093200471*^9}, {3.701153206348943*^9, 3.7011532113252277`*^9}, 
   3.7011533289039526`*^9, {3.7011538847667465`*^9, 3.701153892246174*^9}, {
   3.7011539404219294`*^9, 3.7011539458542404`*^9}, {3.70115406124584*^9, 
   3.7011540903895073`*^9}, {3.7011541351580677`*^9, 
   3.7011541397973332`*^9}, {3.7011541777575045`*^9, 
   3.7011542251342144`*^9}, {3.7011546869696293`*^9, 3.70115468976879*^9}, 
   3.7024507413374643`*^9, {3.7024512869704723`*^9, 3.7024513004549913`*^9}, {
   3.7024517680392046`*^9, 3.7024517940491743`*^9}, {3.7024523211815023`*^9, 
   3.702452389175498*^9}, {3.7024524603793497`*^9, 3.7024524631137357`*^9}, {
   3.702452599950498*^9, 3.702452602684901*^9}, {3.7024526474197407`*^9, 
   3.7024527254141984`*^9}, {3.702452981017902*^9, 3.702452981674161*^9}, {
   3.7024533036229367`*^9, 3.702453340842122*^9}, {3.7024536316945596`*^9, 
   3.7024536930872087`*^9}, {3.7024537258062677`*^9, 
   3.7024537634317093`*^9}, {3.702453795409482*^9, 3.702453809034627*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`dt$$ = 0, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`dt$$], 0, 0.05, 0.001}}, Typeset`size$$ = {
    360., {177., 183.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`dt$582$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`dt$$ = 0}, 
      "ControllerVariables" :> {
        Hold[$CellContext`dt$$, $CellContext`dt$582$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`clear[]; $CellContext`force[]; \
$CellContext`accel[$CellContext`dt$$]; $CellContext`bounds[]; \
$CellContext`move[$CellContext`dt$$]; Graphics[{
          PointSize[$CellContext`ps], Blue, 
          Point[
           Part[$CellContext`x, 
            Span[1, $CellContext`n/2]]], Red, 
          Point[
           Part[$CellContext`x, 
            Span[$CellContext`n/2 + 1, $CellContext`n]]]}, 
         PlotRange -> {{-$CellContext`ps, 
            1 + $CellContext`ps}, {-$CellContext`ps, 1 + $CellContext`ps}}]), 
      "Specifications" :> {{$CellContext`dt$$, 0, 0.05, 0.001, 
         AnimationRunning -> False, 
         AppearanceElements -> {
          "ProgressSlider", "PlayPauseButton", "FasterSlowerButtons", 
           "DirectionButton"}}}, 
      "Options" :> {
       ControlType -> Animator, AppearanceElements -> None, DefaultBaseStyle -> 
        "Animate", DefaultLabelStyle -> "AnimateLabel", SynchronousUpdating -> 
        True, ShrinkingDelay -> 10.}, "DefaultOptions" :> {}],
     ImageSizeCache->{411., {215., 222.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Animate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.7024545697525225`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"dt", "=", "0.02"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gif", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"clear", "[", "]"}], ";", 
      RowBox[{"force", "[", "]"}], ";", 
      RowBox[{"accel", "[", "dt", "]"}], ";", 
      RowBox[{"bounds", "[", "]"}], ";", 
      RowBox[{"move", "[", "dt", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PointSize", "[", "ps", "]"}], ",", "Blue", ",", 
          RowBox[{"Point", "[", 
           RowBox[{"x", "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", 
              RowBox[{"n", "/", "2"}]}], "]"}], "]"}], "]"}], ",", "Red", ",", 
          RowBox[{"Point", "[", 
           RowBox[{"x", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{
               RowBox[{"n", "/", "2"}], "+", "1"}], ";;", "n"}], "]"}], "]"}],
            "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "ps"}], ",", 
             RowBox[{"1", "+", "ps"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "ps"}], ",", 
             RowBox[{"1", "+", "ps"}]}], "}"}]}], "}"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], ",", 
     RowBox[{"{", "256", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{"\"\<particles.gif\>\"", ",", "gif", ",", 
   RowBox[{"\"\<DisplayDurations\>\"", "\[Rule]", "0.04"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.702453846394349*^9, 3.7024539443797636`*^9}, {
  3.7024540630851355`*^9, 3.7024540713195763`*^9}, {3.702454105334226*^9, 
  3.7024541168655477`*^9}, {3.702454153156448*^9, 3.702454153687682*^9}, {
  3.7024542451750097`*^9, 3.702454257534554*^9}, {3.7024543132103577`*^9, 
  3.7024543443714237`*^9}, {3.702454536220932*^9, 3.70245454806485*^9}}],

Cell[BoxData["\<\"particles.gif\"\>"], "Output",
 CellChangeTimes->{3.7024546197317266`*^9}]
}, Open  ]]
},
WindowSize->{956, 988},
WindowMargins->{{Automatic, -5}, {Automatic, 0}},
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (July 28, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 136, 3, 30, "Input"],
Cell[CellGroupData[{
Cell[719, 27, 499, 12, 30, "Input"],
Cell[1221, 41, 3152, 60, 88, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4410, 106, 725, 17, 30, "Input"],
Cell[5138, 125, 3210, 79, 107, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8385, 209, 427, 10, 30, "Input"],
Cell[8815, 221, 2436, 58, 50, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11288, 284, 379, 11, 30, "Input"],
Cell[11670, 297, 847, 22, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12554, 324, 359, 10, 30, "Input"],
Cell[12916, 336, 688, 14, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13641, 355, 240, 5, 30, "Input"],
Cell[13884, 362, 1073, 16, 30, "Output"]
}, Open  ]],
Cell[14972, 381, 796, 22, 30, "Input"],
Cell[15771, 405, 636, 17, 30, "Input"],
Cell[16410, 424, 2986, 70, 259, "Input"],
Cell[19399, 496, 416, 13, 30, "Input"],
Cell[19818, 511, 3491, 97, 126, "Input"],
Cell[CellGroupData[{
Cell[23334, 612, 3083, 64, 202, "Input"],
Cell[26420, 678, 2457, 51, 454, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28914, 734, 2078, 50, 145, "Input"],
Cell[30995, 786, 92, 1, 30, "Output"]
}, Open  ]]
}
]
*)

